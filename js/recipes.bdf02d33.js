(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["recipes"],{9637:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"pb-6 px-lg-12",attrs:{fluid:"",id:"recipes"}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-container",{staticClass:"d-flex justify-center"},[r("v-sheet",{staticClass:"searchbar-big rounded-xl d-flex align-center"},[r("v-icon",{staticClass:"px-3"},[e._v("mdi-magnify")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],attrs:{type:"text",placeholder:"搜尋食譜 / 食材 / 作者"},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}})],1)],1)],1),r("v-col",{staticClass:"mb-lg-8",attrs:{cols:"12"}},[r("v-row",{staticClass:"d-flex align-center"},[r("v-col",{staticClass:"relative",attrs:{cols:"12"}},[r("v-row",{staticClass:"d-flex align-center"},[r("v-col",{staticClass:"text-center order-lg-2",attrs:{cols:"12",lg:"6"}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-btn",{staticClass:"selectborder",class:e.kindactive("all"),attrs:{small:"",elevation:"1",height:"38px"},on:{click:function(t){return e.changekind("all")}}},[r("span",{staticClass:"icon-all"},[e._v("A"),r("span",{staticClass:"lowercase"},[e._v("ll")])]),r("span",{staticClass:"ml-2 font-weight-bold d-none d-md-flex"},[e._v("全部食譜")])]),r("v-btn",{staticClass:"selectborder mx-5",class:e.kindactive("text"),attrs:{small:"",elevation:"1",height:"38px"},on:{click:function(t){return e.changekind("text")}}},[r("v-icon",[e._v("mdi-book-open-outline")]),r("span",{staticClass:"ml-2 font-weight-bold d-none d-md-flex"},[e._v("文字食譜")])],1),r("v-btn",{staticClass:"selectborder",class:e.kindactive("video"),attrs:{small:"",elevation:"1",height:"38px"},on:{click:function(t){return e.changekind("video")}}},[r("v-icon",[e._v("mdi-television-classic")]),r("span",{staticClass:"ml-2 font-weight-bold d-none d-md-flex"},[e._v("影片食譜")])],1)],1)],1)],1),r("v-col",{staticClass:"d-flex justify-start align-center order-lg-1",attrs:{cols:"6",lg:"3"}},[r("v-menu",{attrs:{"close-on-content-click":!1,"nudge-bottom":50},scopedSlots:e._u([{key:"activator",fn:function(t){t.on,t.attrs;return[r("div",{staticClass:"custom-btn",on:{click:function(t){e.sortdia=!e.sortdia}}},[r("div",{staticClass:"selectbox leftbtn"},[r("v-icon",{staticClass:"black--text lefticon"},[e._v("mdi-chevron-down")]),r("span",{staticClass:"font-h3"},[e._v("熱門食譜")])],1)])]}}]),model:{value:e.sortdia,callback:function(t){e.sortdia=t},expression:"sortdia"}},[r("v-card",[r("v-list",[r("v-list-item-group",{attrs:{mandatory:""},model:{value:e.sort,callback:function(t){e.sort=t},expression:"sort"}},e._l(e.select,(function(t){return r("v-list-item",{key:t,attrs:{value:t}},[e._v(e._s(e.selecttext(t)))])})),1)],1)],1)],1)],1),r("v-col",{staticClass:"d-flex justify-end align-center order-lg-3",attrs:{cols:"6",lg:"3"}},[r("v-menu",{attrs:{"close-on-content-click":!1,"nudge-left":"380","nudge-bottom":50,"max-width":"500"},scopedSlots:e._u([{key:"activator",fn:function(t){t.on,t.attrs;return[r("div",{staticClass:"custom-btn",on:{click:function(t){e.filter=!e.filter}}},[r("div",{staticClass:"selectbox rightbtn"},[r("div",{staticClass:"righticon"},[r("v-img",{attrs:{src:s("aad6")}})],1),r("span",{staticClass:"font-h3"},[e._v("食譜分類")])])])]}}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[r("v-card",{staticClass:"rounded-xl pa-6 pr-7 pt-12"},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-row",e._l(e.classify,(function(t){return r("v-col",{key:t,staticClass:"pb-0",attrs:{cols:"6",sm:"4",lg:"4"}},[r("v-sheet",{staticClass:"pointer d-flex align-center justify-center"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.choose,expression:"choose"}],attrs:{type:"checkbox",id:t},domProps:{value:t,checked:Array.isArray(e.choose)?e._i(e.choose,t)>-1:e.choose},on:{change:function(s){var r=e.choose,i=s.target,a=!!i.checked;if(Array.isArray(r)){var n=t,c=e._i(r,n);i.checked?c<0&&(e.choose=r.concat([n])):c>-1&&(e.choose=r.slice(0,c).concat(r.slice(c+1)))}else e.choose=a}}}),r("label",{staticClass:"checktext d-flex align-center",attrs:{for:t}},[r("v-icon",{class:e.checkclass(t)},[e._v(e._s(e.checktext(t)))]),r("span",{staticClass:"ml-2"},[e._v(e._s(t))])],1)])],1)})),1)],1),r("v-col",{staticClass:"pt-10",attrs:{cols:"12"}},[r("v-divider")],1),r("v-col",{staticClass:"px-6",attrs:{cols:"12"}},[r("v-sheet",{staticClass:"d-flex align-center"},[r("v-sheet",[r("v-btn",{attrs:{text:"",disabled:0===e.choose.length},on:{click:e.cleanchoose}},[e._v("清除選取項目")])],1),r("v-spacer"),r("v-sheet",[r("div",[e._v(e._s(e.filternum))])])],1)],1)],1)],1)],1)],1)],1)],1)],1)],1),e._l(e.showrecipes,(function(t,s){return r("v-col",{key:t._id,attrs:{cols:"12",md:"3",sm:"6"}},[r("RecipeCard",{attrs:{recipe:t,nowuser:e.nowuser},on:{sendlike:function(t){return e.likes(s)},sendfav:function(t){return e.favorites(s)}}})],1)}))],2)],1)},i=[],a=s("1da1"),n=(s("96cf"),s("d81d"),s("a434"),s("a15b"),s("4e827"),s("99af"),s("4de4"),s("caad"),s("2532"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{attrs:{id:"recipecard",flat:""}},[s("router-link",{attrs:{to:"/recipe/"+e.recipe._id}},[s("v-img",{staticClass:"rounded-lg imgheight draktop",attrs:{src:e.recipe.image[0]}},[s("div",{staticClass:"d-flex align-center"},[s("v-btn",{attrs:{"x-small":"",fab:"",icon:""},on:{click:function(t){return t.preventDefault(),e.sendlike.apply(null,arguments)}}},[s("v-icon",{staticClass:"white--text"},[e._v(e._s(e.likeicon))])],1),s("span",{staticClass:"overline white--text"},[e._v(e._s(e.recipe.likes.length))]),s("v-btn",{attrs:{"x-small":"",fab:"",icon:""},on:{click:function(t){return t.preventDefault(),e.sendfav.apply(null,arguments)}}},[s("v-icon",{staticClass:"white--text"},[e._v(e._s(e.favicon))])],1),s("v-spacer"),e.recipe.video?s("v-sheet",{staticClass:"text-caption red white--text px-1 mr-3",attrs:{rounded:""}},[e._v("video")]):e._e()],1)])],1),s("div",{staticClass:"pt-3"},[s("div",{staticClass:"mb-1 recipetitle single-line"},[e._v(e._s(e.recipe.name))]),s("v-sheet",[s("div",{staticClass:"d-flex align-center"},[s("router-link",{staticClass:"d-flex align-center",attrs:{to:"/user/"+e.recipe.author._id}},[e.recipe.author.avatar&&0!==e.recipe.author.avatar.length?s("v-avatar",{staticClass:"d-flex mr-3",attrs:{size:e.avatar.size}},[s("img",{attrs:{src:e.recipe.author.avatar[0]}})]):s("avatar",{staticClass:"d-flex mr-3",attrs:{size:e.avatar.size,name:e.recipe.author.account,variant:e.avatar.variant,colors:e.avatar.colors}}),s("div",[s("div",{staticClass:"mb-1 single-line text-subtitle-1 black--text"},[e._v(e._s(e.username))]),s("div",{staticClass:"single-line text-subtitle-2 grey--text font-weight-light mt-n2"},[e._v(e._s(e.recipe.author.recipes)+" 道食譜 "+e._s(e.recipe.author.follower)+" 位粉絲")])])],1)],1)])],1)],1)}),c=[],o={name:"RecipeCard",data:function(){return{avatar:{size:45,colors:["#F0F2DC","#F9D365","#D9EB52","#87796F","#9FA789"],variant:"beam"}}},props:{recipe:{type:Object,required:!0},nowuser:{type:Object}},computed:{likeicon:function(){return this.recipe.like?"mdi-heart":"mdi-heart-outline"},favicon:function(){return this.recipe.favorite?"mdi-bookmark":"mdi-bookmark-outline"},username:function(){return this.recipe.author.username?this.recipe.author.username:this.recipe.author.account}},methods:{sendlike:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.user.islogin){t.next=6;break}return t.next=3,e.axios.patch("/users/like/"+e.$store.state.user._id,{_id:e.recipe._id},{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:e.$emit("sendlike"),t.next=7;break;case 6:e.$router.push("/login");case 7:case"end":return t.stop()}}),t)})))()},sendfav:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.user.islogin){t.next=6;break}return t.next=3,e.axios.patch("/users/favorite/"+e.$store.state.user._id,{_id:e.recipe._id},{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:e.$emit("sendfav"),t.next=7;break;case 6:e.$router.push("/login");case 7:case"end":return t.stop()}}),t)})))()}}},l=o,u=s("2877"),d=s("6544"),p=s.n(d),v=s("8212"),h=s("8336"),f=s("b0af"),m=s("132d"),k=s("adda"),g=s("8dd9"),x=s("2fa4"),b=Object(u["a"])(l,n,c,!1,null,null,null),w=b.exports;p()(b,{VAvatar:v["a"],VBtn:h["a"],VCard:f["a"],VIcon:m["a"],VImg:k["a"],VSheet:g["a"],VSpacer:x["a"]});var _=s("402c"),C={name:"Recipes",data:function(){return{recipes:[],showrecipes:[],nowuser:{likes:[],favorites:[]},filter:!1,sortdia:!1,kind:"all",query:"",choose:[],sort:"likes",select:["likes","publish_date"],classify:["烘焙甜點","家常菜色","電鍋料理","蔬食料理","異國料理","快速上桌","飲料冰品","節慶料理","寶寶兒童","寵物料理"]}},components:{RecipeCard:w,vuetify:_["a"]},computed:{filternum:function(){return this.choose.length>0?"共選 ".concat(this.choose.length," 項分類"):"尚未選擇分類"}},methods:{likes:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:t.recipes[e].like?(r=t.recipes[e].likes.map((function(e){return e.users})).indexOf(t.$store.state.user._id),t.recipes[e].likes.splice(r,1),i=t.nowuser.likes.map((function(e){return e.recipes})).indexOf(t.recipes[e]._id),t.nowuser.likes.splice(i,1)):(t.recipes[e].likes.push({user:t.$store.state.user._id}),t.nowuser.likes.push({recipes:t.recipes[e]._id})),t.recipes[e].like=!t.recipes[e].like;case 2:case"end":return s.stop()}}),s)})))()},favorites:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:t.recipes[e].favorite?(r=t.nowuser.favorites.map((function(e){return e.recipes})).indexOf(t.recipes[e]._id),t.nowuser.favorites.splice(r,1)):t.nowuser.favorites.push({recipes:t.recipes[e]._id}),t.recipes[e].favorite=!t.recipes[e].favorite;case 2:case"end":return s.stop()}}),s)})))()},searchquery:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,s=e.choose.join(","),t.next=4,e.axios.get("/recipes/?keywords="+e.query+"&chooses="+s+"&sort="+e.sort);case 4:r=t.sent,i=r.data,e.recipes=i.result.map((function(e){return e.image&&(e.image=e.image.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e.favorite=!1,e.like=!1,e.author.avatar&&(e.author.avatar=e.author.avatar.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e})),e.recipes=e.recipes.filter((function(e){return 0!==e.isEnabled})),e.showrecipes=e.recipes,t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])})))()},checkclass:function(e){return this.choose.includes(e)?"checkbox-check":"checkbox-default"},checktext:function(e){return this.choose.includes(e)?"mdi-check":""},selecttext:function(e){return"likes"===e?"熱門食譜":"最新發佈"},cleanchoose:function(){this.choose=[]},changekind:function(e){this.kind="".concat(e)},kindactive:function(e){return this.kind===e?"kind-active":""},kindfilter:function(){var e=this;"text"===this.kind&&(this.showrecipes=this.recipes.filter((function(t){return t.type===e.kind}))),"video"===this.kind&&(this.showrecipes=this.recipes.filter((function(t){return t.type===e.kind}))),"all"===this.kind&&(this.showrecipes=this.recipes)}},mounted:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("/recipes/?sort=likes");case 3:if(s=t.sent,r=s.data,e.recipes=r.result.map((function(e){return e.image&&(e.image=e.image.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e.favorite=!1,e.like=!1,e.author.avatar&&(e.author.avatar=e.author.avatar.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e})),e.recipes=e.recipes.filter((function(e){return 0!==e.isEnabled})),!e.user.islogin){t.next=14;break}return t.next=10,e.axios.get("/users/"+e.$store.state.user._id);case 10:i=t.sent,e.nowuser={likes:i.data.result.likes,favorites:i.data.result.favorites},void 0!==e.nowuser.likes?e.recipes.map((function(t){return t.like=e.nowuser.likes.some((function(e){return e.recipes===t._id})),t})):e.recipe.like=!1,void 0!==e.nowuser.favorites?e.recipes.map((function(t){return t.favorite=e.nowuser.favorites.some((function(e){return e.recipes===t._id})),t})):e.recipe.favorite=!1;case 14:e.showrecipes=e.recipes,t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得食譜錯誤"});case 20:case"end":return t.stop()}}),t,null,[[0,17]])})))()},watch:{choose:{handler:function(e,t){this.searchquery()},deep:!0},sort:{handler:function(e,t){this.searchquery()},deep:!0},query:{handler:function(e,t){this.searchquery()}},kind:{handler:function(e,t){this.kindfilter()},deep:!0}}},y=C,V=s("62ad"),j=s("a523"),R=s("ce7e"),$=s("8860"),O=s("da13"),q=s("1baa"),z=s("e449"),A=s("0fd9"),D=Object(u["a"])(y,r,i,!1,null,null,null);t["default"]=D.exports;p()(D,{VBtn:h["a"],VCard:f["a"],VCol:V["a"],VContainer:j["a"],VDivider:R["a"],VIcon:m["a"],VImg:k["a"],VList:$["a"],VListItem:O["a"],VListItemGroup:q["a"],VMenu:z["a"],VRow:A["a"],VSheet:g["a"],VSpacer:x["a"]})},aad6:function(e,t,s){e.exports=s.p+"img/filter_list_black_24dp.9bee6b17.svg"}}]);
//# sourceMappingURL=recipes.bdf02d33.js.map