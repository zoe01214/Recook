(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["recipes"],{9637:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0 px-lg-12 mb-12",attrs:{fluid:"",id:"recipes"}},[i("v-row",{staticClass:"mx-3 mx-lg-10"},[i("v-col",{staticClass:"px-0",attrs:{cols:"12"}},[i("div",{staticClass:"d-flex justify-center"},[i("v-sheet",{staticClass:"searchbar-big rounded-xl d-flex align-center"},[i("v-icon",{staticClass:"px-3"},[e._v("mdi-magnify")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],attrs:{type:"text",placeholder:"搜尋食譜 / 食材 / 作者"},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}})],1)],1)]),i("v-col",{staticClass:"px-0 mb-lg-8",attrs:{cols:"12"}},[i("v-row",{staticClass:"d-flex align-center"},[i("v-col",{staticClass:"relative",attrs:{cols:"12"}},[i("v-row",{staticClass:"d-flex align-center"},[i("v-col",{staticClass:"text-center order-lg-2",attrs:{cols:"12",lg:"6"}},[i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-btn",{staticClass:"selectborder",class:e.kindactive("all"),attrs:{small:"",elevation:"1",height:"38px"},on:{click:function(t){return e.changekind("all")}}},[i("span",{staticClass:"icon-all"},[e._v("A"),i("span",{staticClass:"lowercase"},[e._v("ll")])]),i("span",{staticClass:"ml-2 font-weight-bold d-none d-md-flex"},[e._v("全部食譜")])]),i("v-btn",{staticClass:"selectborder mx-5",class:e.kindactive("text"),attrs:{small:"",elevation:"1",height:"38px"},on:{click:function(t){return e.changekind("text")}}},[i("v-icon",[e._v("mdi-book-open-outline")]),i("span",{staticClass:"ml-2 font-weight-bold d-none d-md-flex"},[e._v("文字食譜")])],1),i("v-btn",{staticClass:"selectborder",class:e.kindactive("video"),attrs:{small:"",elevation:"1",height:"38px"},on:{click:function(t){return e.changekind("video")}}},[i("v-icon",[e._v("mdi-television-classic")]),i("span",{staticClass:"ml-2 font-weight-bold d-none d-md-flex"},[e._v("影片食譜")])],1)],1)],1)],1),i("v-col",{staticClass:"d-flex justify-start align-center order-lg-1",attrs:{cols:"6",lg:"3"}},[i("v-menu",{attrs:{"close-on-content-click":!1,"nudge-bottom":50},scopedSlots:e._u([{key:"activator",fn:function(t){t.on,t.attrs;return[i("div",{staticClass:"custom-btn",on:{click:function(t){e.sortdia=!e.sortdia}}},[i("div",{staticClass:"selectbox leftbtn"},[i("v-icon",{staticClass:"black--text lefticon"},[e._v("mdi-chevron-down")]),i("span",{staticClass:"font-h3"},[e._v("熱門食譜")])],1)])]}}]),model:{value:e.sortdia,callback:function(t){e.sortdia=t},expression:"sortdia"}},[i("v-card",[i("v-list",[i("v-list-item-group",{attrs:{mandatory:""},model:{value:e.sort,callback:function(t){e.sort=t},expression:"sort"}},e._l(e.select,(function(t){return i("v-list-item",{key:t,attrs:{value:t}},[e._v(e._s(e.selecttext(t)))])})),1)],1)],1)],1)],1),i("v-col",{staticClass:"d-flex justify-end align-center order-lg-3",attrs:{cols:"6",lg:"3"}},[i("v-menu",{attrs:{"close-on-content-click":!1,"nudge-left":"380","nudge-bottom":50,"max-width":"500"},scopedSlots:e._u([{key:"activator",fn:function(t){t.on,t.attrs;return[i("div",{staticClass:"custom-btn",on:{click:function(t){e.filter=!e.filter}}},[i("div",{staticClass:"selectbox rightbtn"},[i("div",{staticClass:"righticon"},[i("v-img",{attrs:{src:s("aad6")}})],1),i("span",{staticClass:"font-h3"},[e._v("食譜分類")])])])]}}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[i("v-card",{staticClass:"rounded-xl pa-6 pr-7 pt-12"},[i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-row",e._l(e.classify,(function(t){return i("v-col",{key:t,staticClass:"pb-0",attrs:{cols:"6",sm:"4",lg:"4"}},[i("v-sheet",{staticClass:"pointer d-flex align-center justify-center"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.choose,expression:"choose"}],attrs:{type:"checkbox",id:t},domProps:{value:t,checked:Array.isArray(e.choose)?e._i(e.choose,t)>-1:e.choose},on:{change:function(s){var i=e.choose,r=s.target,a=!!r.checked;if(Array.isArray(i)){var n=t,c=e._i(i,n);r.checked?c<0&&(e.choose=i.concat([n])):c>-1&&(e.choose=i.slice(0,c).concat(i.slice(c+1)))}else e.choose=a}}}),i("label",{staticClass:"checktext d-flex align-center",attrs:{for:t}},[i("v-icon",{class:e.checkclass(t)},[e._v(e._s(e.checktext(t)))]),i("span",{staticClass:"ml-2"},[e._v(e._s(t))])],1)])],1)})),1)],1),i("v-col",{staticClass:"pt-10",attrs:{cols:"12"}},[i("v-divider")],1),i("v-col",{staticClass:"px-6",attrs:{cols:"12"}},[i("v-sheet",{staticClass:"d-flex align-center"},[i("v-sheet",[i("v-btn",{attrs:{text:"",disabled:0===e.choose.length},on:{click:e.cleanchoose}},[e._v("清除選取項目")])],1),i("v-spacer"),i("v-sheet",[i("div",[e._v(e._s(e.filternum))])])],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1),i("v-row",{staticClass:"mx-1 mx-lg-8"},e._l(e.showrecipes,(function(t,s){return i("v-col",{key:t._id,attrs:{cols:"12",lg:"3",md:"4",sm:"6"}},[i("RecipeCard",{attrs:{recipe:t,nowuser:e.nowuser},on:{sendlike:function(t){return e.likes(s)},sendfav:function(t){return e.favorites(s)}}})],1)})),1),i("loading",{attrs:{height:45,width:45,active:e.isLoading},on:{"update:active":function(t){e.isLoading=t}}})],1)},r=[],a=s("1da1"),n=(s("96cf"),s("d81d"),s("a434"),s("a15b"),s("4e827"),s("99af"),s("4de4"),s("caad"),s("2532"),s("6b0a")),c=s("402c"),o={name:"Recipes",data:function(){return{recipes:[],showrecipes:[],isLoading:!1,fullPage:!0,nowuser:{likes:[],favorites:[]},filter:!1,sortdia:!1,kind:"all",query:"",choose:[],sort:"likes",select:["likes","publish_date"],classify:["烘焙甜點","家常菜色","電鍋料理","蔬食料理","異國料理","快速上桌","飲料冰品","節慶料理","寶寶兒童","寵物料理"]}},components:{RecipeCard:n["a"],vuetify:c["a"]},computed:{filternum:function(){return this.choose.length>0?"共選 ".concat(this.choose.length," 項分類"):"尚未選擇分類"}},methods:{likes:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var i,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:t.recipes[e].like?(i=t.recipes[e].likes.map((function(e){return e.users})).indexOf(t.$store.state.user._id),t.recipes[e].likes.splice(i,1),r=t.nowuser.likes.map((function(e){return e.recipes})).indexOf(t.recipes[e]._id),t.nowuser.likes.splice(r,1)):(t.recipes[e].likes.push({user:t.$store.state.user._id}),t.nowuser.likes.push({recipes:t.recipes[e]._id})),t.recipes[e].like=!t.recipes[e].like;case 2:case"end":return s.stop()}}),s)})))()},favorites:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:t.recipes[e].favorite?(i=t.nowuser.favorites.map((function(e){return e.recipes})).indexOf(t.recipes[e]._id),t.nowuser.favorites.splice(i,1)):t.nowuser.favorites.push({recipes:t.recipes[e]._id}),t.recipes[e].favorite=!t.recipes[e].favorite;case 2:case"end":return s.stop()}}),s)})))()},searchquery:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,s=e.choose.join(","),t.next=4,e.axios.get("/recipes/?keywords="+e.query+"&chooses="+s+"&sort="+e.sort);case 4:i=t.sent,r=i.data,e.recipes=r.result.map((function(e){return e.image&&(e.image=e.image.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e.favorite=!1,e.like=!1,e.author.avatar&&(e.author.avatar=e.author.avatar.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e})),e.recipes=e.recipes.filter((function(e){return 0!==e.isEnabled})),e.showrecipes=e.recipes,t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])})))()},checkclass:function(e){return this.choose.includes(e)?"checkbox-check":"checkbox-default"},checktext:function(e){return this.choose.includes(e)?"mdi-check":""},selecttext:function(e){return"likes"===e?"熱門食譜":"最新發佈"},cleanchoose:function(){this.choose=[]},changekind:function(e){this.kind="".concat(e)},kindactive:function(e){return this.kind===e?"kind-active":""},kindfilter:function(){var e=this;"text"===this.kind&&(this.showrecipes=this.recipes.filter((function(t){return t.type===e.kind}))),"video"===this.kind&&(this.showrecipes=this.recipes.filter((function(t){return t.type===e.kind}))),"all"===this.kind&&(this.showrecipes=this.recipes)}},mounted:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,i,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,s=e,s.isLoading=!0,t.next=5,e.axios.get("/recipes/?sort=likes");case 5:if(i=t.sent,r=i.data,e.recipes=r.result.map((function(e){return e.image&&(e.image=e.image.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e.favorite=!1,e.like=!1,e.author.avatar&&(e.author.avatar=e.author.avatar.map((function(e){return"".concat("https://recook-recipe-web.herokuapp.com","/files/").concat(e)}))),e})),s.isLoading=!1,e.recipes=e.recipes.filter((function(e){return 0!==e.isEnabled})),!e.user.islogin){t.next=17;break}return t.next=13,e.axios.get("/users/"+e.$store.state.user._id);case 13:a=t.sent,e.nowuser={likes:a.data.result.likes,favorites:a.data.result.favorites},void 0!==e.nowuser.likes?e.recipes.map((function(t){return t.like=e.nowuser.likes.some((function(e){return e.recipes===t._id})),t})):e.recipe.like=!1,void 0!==e.nowuser.favorites?e.recipes.map((function(t){return t.favorite=e.nowuser.favorites.some((function(e){return e.recipes._id===t._id})),t})):e.recipe.favorite=!1;case 17:e.showrecipes=e.recipes,t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得食譜錯誤"});case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))()},watch:{choose:{handler:function(e,t){this.searchquery()},deep:!0},sort:{handler:function(e,t){this.searchquery()},deep:!0},query:{handler:function(e,t){this.searchquery()}},kind:{handler:function(e,t){this.kindfilter()},deep:!0}}},l=o,u=s("2877"),d=s("6544"),p=s.n(d),v=s("8336"),f=s("b0af"),h=s("62ad"),m=s("a523"),k=s("ce7e"),g=s("132d"),x=s("adda"),w=s("8860"),b=s("da13"),_=s("1baa"),C=s("e449"),y=s("0fd9"),V=s("8dd9"),R=s("2fa4"),q=Object(u["a"])(l,i,r,!1,null,null,null);t["default"]=q.exports;p()(q,{VBtn:v["a"],VCard:f["a"],VCol:h["a"],VContainer:m["a"],VDivider:k["a"],VIcon:g["a"],VImg:x["a"],VList:w["a"],VListItem:b["a"],VListItemGroup:_["a"],VMenu:C["a"],VRow:y["a"],VSheet:V["a"],VSpacer:R["a"]})},aad6:function(e,t,s){e.exports=s.p+"img/filter_list_black_24dp.9bee6b17.svg"}}]);
//# sourceMappingURL=recipes.a6b4c977.js.map